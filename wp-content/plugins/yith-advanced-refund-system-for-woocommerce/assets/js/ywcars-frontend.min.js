jQuery(function(e){e(document).ready(function(e){e("#ywcars_form_my_account_new_message").on("submit",function(a){a.preventDefault(),e("div.ywcars_alert").hide();var t=e("div.ywcars_view_request"),r=e("textarea#ywcars_new_message"),s=e("input#ywcars_request_id").val();if(r.val()&&s){form_data=new FormData(this),fields_filled=!0,form_data.append("action","ywcars_submit_message"),form_data.append("security",localize_js_ywcars_frontend.ywcars_submit_message),form_data.append("request_id",s);var o={type:"POST",url:localize_js_ywcars_frontend.ajax_url,data:form_data,success:function(a,t,s){a.success&&"ywcars_message_submitted_correctly"==a.data?(e("div.ywcars_success_alert").show().find("span.ywcars_alert_content").text(localize_js_ywcars_frontend.success_message),r.val("")):e("div.ywcars_error_alert").show().find("span.ywcars_alert_content").text(a.data)},error:function(a,t,r){e("div.ywcars_error_alert").show().find("span.ywcars_alert_content").text(r)},complete:function(){t.unblock(),e("span.ywcars_update_messages").trigger("click")},cache:!1,contentType:!1,processData:!1};t.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.ajax(o)}else e("div.ywcars_error_alert").show().find("span.ywcars_alert_content").text(localize_js_ywcars_frontend.fill_fields)}),e(".ywcars_close_alert").on("click",function(){e(this).closest("div.ywcars_alert").hide()}),e("span.ywcars_update_messages").on("click",function(a){a.preventDefault();var t=e("input#ywcars_request_id").val(),r=e("div.ywcars_messages_history_frame"),s=e("div#ywcars_message_history");if(t){var o={action:"ywcars_update_messages",security:localize_js_ywcars_frontend.ywcars_update_messages,request_id:t};s.block({message:localize_js_ywcars_frontend.reloading,overlayCSS:{background:"#fff",opacity:.6}}),r.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.post(localize_js_ywcars_frontend.ajax_url,o,function(e){r.empty(),r.prepend(e),s.unblock(),r.unblock()})}}),e(".ywcars_button_refund").each(function(a,t){e(t).prettyPhoto({hook:"data-rel",social_tools:!1,theme:"pp_woocommerce",horizontal_padding:20,opacity:.8,deeplinking:!1,modal:!0,keyboard_shortcuts:!1,changepicturecallback:function(){e(document.body).trigger("ywcars_request_window_created")}})}),e(document.body).on("ywcars_request_window_created",function(){e(document.body).trigger("scroll.prettyphoto"),request_window_content=e("div.pp_content_container"),request_window_close_button=e("a.pp_close"),submit_button=e("#ywcars_submit_button"),e(".ywcars_close_alert").on("click",function(){e(this).closest("div.ywcars_alert").hide()}),e("#ywcars_form").on("submit",function(a){a.preventDefault(),e("div.ywcars_message").hide(),form_data=new FormData(this),fields_filled=!0,form_data.append("action","ywcars_submit_request"),form_data.append("security",localize_js_ywcars_frontend.ywcars_submit_request),whole_order=e("input[name='ywcars_form_whole_order']").val();var t={type:"POST",url:localize_js_ywcars_frontend.ajax_url,data:form_data,success:function(a){a.success&&"ywcars_request_created"==a.data?(submit_button.prop("disabled",!0),window.location.href=window.location.href):e("div.ywcars_error_alert").show().find("span.ywcars_alert_content").text(a.data)},error:function(a,t,r){e("div.ywcars_error_alert").show().find("span.ywcars_alert_content").text(r)},complete:function(){request_window_content.unblock(),request_window_close_button.show()},cache:!1,contentType:!1,processData:!1};reason=e("textarea[name='ywcars_form_reason']").val(),fields_filled=!!reason,whole_order||(qty=e("input[name='ywcars_form_qty']").val(),fields_filled=!(!qty||!reason)),fields_filled?(request_window_content.block({message:null,overlayCSS:{background:"#f1f1f1",opacity:.7}}),request_window_close_button.hide(),e.ajax(t)):e("div.ywcars_error_alert").show().find("span.ywcars_alert_content").text(localize_js_ywcars_frontend.fill_fields)})})})});